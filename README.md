# GeminiAiBot
Позволяет создать бота с gemini для телеграмма(возможно и для других платформ) с возможностью обхода региональных ограничений

# Что можно создать, используя эти инструменты и некие базовые навыки программирования:
- любое количество ботов для телеграмма, использующих разные настройки и персонажей, все прописывается в отдельных файлах.
- сохранение истории и настроек пользователей для каждого из ботов.
- очень примитивный синтаксис, который легко модифицировать.
- основные функции вынесены в отдельное ядро для более простой модификации.
- лаунчер ботов, который будет их перезапускать в случае ошибки(например у вас временно отвалился интернет).
- при анализе данного кода, его легко переделать под любую нейросеть и любое средство вывода.
- так как изначально для работы был выбран gemini, то имеется способ обхода регионального ограничения(до этого такого нигде не видел, так что около уникально), этот подход вероятно всего подойдет для любого сервиса, от которого нужен единоразовый ответ, или потоковый, который можно вернуть единоразово, далее будет объяснение принципа работы).

# Как тут все работает:
Во-первых в коде основные функции либо понятно названы и очень примитивны, либо имеют информацию о себе, а так же (что удивительно для типичной программы на питоне) указаны возвращаемые значения, так что вы можете спокойно использовать текущие наработки для создания чего-нибудь своего. Во-вторых, для тех, кто ничего не хочет делать и вообще не знает как что писать, существует скрипт gemini.py. В нём во-первых расписана почти каждая строчка, плюс при малой настройки вы сможете быстро завести бота с нейросетью gemini-flash 2.0 под капотом и разверткой в телеграме, он будет иметь базовые функции по типу памяти (примечание: при достижении некоего количества сообщений в памят(глубина памяти), самое старое сообщение удаляется, чтобы нейросеть не начала повторяться и не переполнились токены. Глубину памяти можно настроить напрямую в скрипте через функцию загрузки пользователя или из самого бота). 

# Что нужно для этого сделать:
Важно! Если не работает pip, то попробуйте pip3, в противном случае установите pip, в интернете есть инструкции
Для начала вам нужно установить библиотеку pytelegrambotapi
```
pip install pyTelegramBotAPI
```
После этого откройте файл по пути `.../GeminiAiBot/bot_settings/bot_settings.txt` и впишите ваш ключ телеграм бота в строку `Gemini_tba после` `=`, без пробелов!
Теперь вам нужно раздобыть api ключ gemini, можете найти как это сделать в интернете, если вы в стране, в которой gemini официально не работает, можете использовать средства подмены ip и анонимизации.
После этого откройте файл по пути `.../GeminiAiBot/bot_settings/bot_settings.txt` и впишите ваш ключ в строку `public_gemini_api_key после` после  `=`, без пробелов!

# Дальше опцилонально два пути(но желательно сразу оба):
 - Первый если вы будтете выходить в сеть в месте в котором gemini работает.
 - Второй если вы будете запускать с локации, попадающей под ограничения по стране.
   
# Итак, если вы выбираете первый, то:
 - устанавливаете google.generativeai
   ```
    pip install google.generativeai
   ```
 - готово, но вам придется запускат это все с айпи страны, в которой доступен gemini
   
# Если второй, то готовьтесь к пердоллингу:
 - Сначала вам понадобится зайти на google apps script
   https://script.google.com/home/
 - Создайте проект
 - Сотрите там все и вставьте код из файла `.../GeminiAiBot/GoogleAppsScriptHandler.gs`, впишите в переменную `apiKey` ваш ключ к gemini
 - Разверните скрипт(на 2025 год это Начать развертывание -> Новое развертывание -> шестернка у Выберите тип -> Веб-приложение, справа Запуск -> от моего имени, у кого есть доступ -> все, Начать развертывание, Предоставить доступ, войдите там в аккаунт, выскочит предупреждение, не пугаемся, а нажимаем слева Advanced и снизу Go to ... (unsafe), потом нажимаем Allow, нас перебросит обратно в google apps и даст снизу ссылку на Веб-приложение, копируем её).
 - Скопированную ссылку развёрнутого скрипта вы должны закинуть в файл `.../GeminiAiBot/bot_settings/bot_settings.txt` в строку `Gemini_tba` после `=`, без пробелов!

Готово, теперь вы можете открыть терминал в папке и запустить скрипт launcher.py, после чего напишите gemini(или Gemini), (если выдаст ошибку, то измените в нём `python_alias` с `python3` на `pyhton`).
Теперь напишите что-нибудь вашему телеграм боту и увидите как по пути `.../GeminiAiBot/Database` появилась новая папка с именем из цифр, эти цифры - ваш id пользователя телеграм, впишите его в массивы `admins` и `trusted` в скрипте gemini.py.
Конец настройки, максимально базовый текстовый помошник готов, можете расширять его как хотите.

# Теперь пару слов о том как создать нового бота. Во-первых самый базово простой способ это:
 - Сделать дубликат `gemini.py` и назвать его по другому(например `example.py`), теперь для его запуска нужно будет в `launcher.py` вписывать его новое название без расширения имени файла(то есть `example`).
 - В дубликате поменяйте `code_name` на ваше новое имя нейросети, например `Example`.
 - Теперь создайте в файле с настройками бота поля `Example_tba`, в которое впишите ваш ключ к новому боту телеграмма, `Example_version`, в которое впишите версию вашего скрипта(можете вписать что угодно).
 - Чтобы настроить личность этому боту, напишите её в файл `.../GeminiAiBot/bot_settings/Personas/Example.txt` и сохраните.
Для всего выше перечисленного `Example` - ваше новое название нового бота, везде оно должно быть одинаковвым.

Если вам не нужно оповещение о старте бота, то напишите любое значение отличное от `True`(лучше всего `False`) в поле `send_start_info_to_admins` в настройках.
Если не нужно глубокое логирование в консоль, то напишите любое значение отличное от `True`(лучше всего `False`) в поле `use_debug_log` в настройках.

# Как работает обход ограничений по стране:
google apps script доступен (по крайней мере из РФ), мы отсылаем туда запрос, сам скрипт запускается на сервер google в Америке, где gemini достуен, с сервера google идет запрос к gemini, а после получения он отправляется обратно нам. Вот и все, некая виртуальная псевдо-сеть.
